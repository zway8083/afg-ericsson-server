<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="header :: head">
    <title id="pageTitle">Observation</title>
</head>
<head>
	<link href="/css/microphone.css" rel="stylesheet"/>
    <script src="/scripts/dictation.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.2/moment.min.js"></script>
	<script src="/scripts/bootstrap-datetimepicker.min.js"></script>
	<script src="/scripts/fr.js"></script>
    <link rel="stylesheet" href="/css/bootstrap-datetimepicker.min.css"/>
</head>
<body>
	<div th:replace="header :: navbar"></div>
	<div id="main-content" class="container">
		<h2 style="padding-bottom: 15px;">Observation du comportement</h2>
		
	    <div th:if="${initForm}" class="row">
	        <div class='col-md-6'>
	        	<form action="/observation" th:action="@{/observation}" th:object="${form}" method="post">
		            <div class="form-group">
		                <label class="control-label" for="datetimepicker">Jour : </label>
		                <div class='input-group date' id='datetimepicker'>
		                    <input id="date" type='text' class="form-control" th:field="*{date}" required="required"/>
		                    <span class="input-group-addon">
		                        <span class="glyphicon glyphicon-calendar"></span>
		                    </span>
		                </div>
		            </div>
		            <div class="form-group">
		            	<label class="control-label" for="subject">Sujet : </label>
		            	<select id="subject" class="form-control" th:field="*{subjectId}" required="required">
								<option th:each="subject : ${subjects}"
									th:text="${subject.firstName + ' ' + subject.lastName}"
									th:value="${subject.id}"></option>
						</select>
		            </div>
		            <div class="form-group"> 
						<button type="submit" class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> Valider</button>
  					</div>
	            </form>
	        </div>
	        <script type="text/javascript">
	            $(function () {
	                $('#datetimepicker').datetimepicker({
	                    locale: 'fr',
	                    defaultDate: new Date(),
	                    format: 'DD/MM/YYYY'
	                });
	            });
	        </script>
	    </div>

	    <div th:if="${obsForm}" class="table-responsive">
    		<h3 th:text="${form.subjectName}"></h3>
    		<th:block sec:authorize="hasAuthority('CREATE_BEHAVIOUR_OBSERVATION')">
		    	<div th:replace="observation-fragments:: main(canCreate=true,form=${form})"></div>
    		</th:block>
    		<th:block sec:authorize="!hasAuthority('CREATE_BEHAVIOUR_OBSERVATION')">
		    	<div th:replace="observation-fragments:: main(canCreate=false,form=${form})"></div>
    		</th:block>
	    </div>
    </div>
</body>
<script src="/scripts/speech-input.js"></script>
</html>